<!DOCTYPE html>
<html lang="en">
<head>

  <style>
    td.center {
      text-align:left;
    }
  </style>

  <%- include('../partials/head.ejs') %>

</head>
<body>

  <%- include('../partials/scripts.ejs') %>

  <%- include('../partials/navbar.ejs') %>

  <link href="./assets/css/jquery.dataTables.min.css" rel="stylesheet"></script>
  <script src="./assets/js/jquery.dataTables.min.js"></script>

  <div class="container-fluid">
      <div class="row flex-nowrap">
          <%- include('../partials/sidebar.ejs') %>
          <div class="col py-3">
            <div class="row">
              <div class="col-sm-12 mb-3 mb-sm-0">
                <div class="content-header">
                  <h5>Display Devices</h5>
                </div>
                <div class="card">
                  <table id="devices" class="display" style="width:100%">
                    <thead>
                        <tr>
                            <th>uid</th>
                            <th>model</th>
                            <th>fw</th>
                            <th>app</th>
                            <th>status</th>
                        </tr>
                    </thead>
                  </table>
                </div>
              </div>
            </div>
          </div>
      </div>
  </div>

  <script>
    var t;
    $(document).ready(function () {
      t = $('#devices').DataTable();

      api.getDevices((err,res)=>{
        if(err) console.log("err:",err)
        else{
          res.forEach((item, i) => {
            addRow(item.uid,item.model,item.fw_version,item.app_version,item.status);
          });
        }
      });
    });

    function addRow(uid,model,fwV,appV,status){

      t.row.add([`
        <a href="./device/`+uid+`">`+uid+`</a>
        `,model,fwV,appV,status]).draw(true);
      /*
      $('#devices tbody').append(
        `<tr>`,
        `<td>`+uid+`</td>`,
        `<td>`+model+`</td>`,
        `<td>`+fwV+`</td>`,
        `<td>`+appV+`</td>`,
        `<td>`+status+`</td>`,
        `</tr>`
      );
      */
    }
  </script>
</body>
</html>
